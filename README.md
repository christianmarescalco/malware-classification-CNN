# Malware Classification using Convolutional Neural Networks (CNNs)
This GitHub repository contains an implementation of a malware classification system using Convolutional Neural Networks (CNNs). The goal of this project is to develop a model capable of accurately classifying different types of malware based on their input executable as an image.

First implementation `malimg_classifier` trained on 25 malware classes from Malimg dataset.

A second implementation `combined_classifier` includes in the dataset a benign class extracted from PE legitimate samples in [DikeDataset](https://github.com/iosifache/DikeDataset/tree/main).

The full explanation of the experiments can be found in `presentation.pdf`.

## Introduction
Malware (malicious software) poses a significant threat to computer systems and networks worldwide. It is crucial to detect and classify malware accurately to prevent potential security breaches. This project focuses on leveraging the power of CNNs, a deep learning technique commonly used in computer vision tasks, to classify malware samples into different categories.

## Dataset
The dataset Malimg used for this project contains labeled samples of different types of malware. Each sample is stored in a separate directory, with the directory name indicating the malware class. 
A benign subset is stored in another folder which is uploaded in this repository in `benign_data`, while the Malimg dataset can be found [here](https://paperswithcode.com/dataset/malimg).
The dataset is organized in the following structure:

```
malimg_dataset/
├── class1/
│ ├── malware1.png
│ ├── malware2.png
│ ├── ...
├── class2/
│ ├── malware3.png
│ ├── malware4.png
│ ├── ...
├── ...
benign_data/
├── benign_imgs/
│ ├── sample1.png
│ ├── sample2.png
│ ├── ...
```

### Dataset samples for each class
![Image samples for each class](./imgs/dataset_combined.png)

### Benign data conversion
![Data conversion](./imgs/flow.png)

You can find the full code in `utils/data_conversion.ipynb`.


## Model Architecture
The CNN model architecture used in this project consists of several convolutional layers, followed by pooling layers and fully connected layers. The CNN workflow is the following:

![CNN architecture](./imgs/cnn.png)

## Final Training


### Confusion matrix on combined classifier

![Confusion matrix](https://github.com/christianmarescalco/malware-classification-CNN/blob/main/imgs/confusion.png)

### Evaluation metrics on combined classifier

![Metrics](https://github.com/christianmarescalco/malware-classification-CNN/blob/main/imgs/combined_model_metrics.png)








